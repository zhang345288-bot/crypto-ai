(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{743:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>y});var a=s(5155),n=s(2115),l=s(2821),o=s(5889);function r(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card",className:function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,o.QP)((0,l.$)(t))}("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...s})}let i=(0,s(7909).default)(()=>Promise.all([s.e(840),s.e(991)]).then(s.bind(s,6614)),{loadableGenerated:{webpack:()=>[6614]},ssr:!1});function c(e){let{symbol:t,interval:s="60",limit:l=200,shouldLoad:o=!1,indicator:c=""}=e,[d,m]=(0,n.useState)(!1),[g,x]=(0,n.useState)(""),[u,p]=(0,n.useState)(null),h=(0,n.useRef)(null),b=(0,n.useRef)(null),[f,y]=(0,n.useState)(null),[v,w]=(0,n.useState)(!1),[j,N]=(0,n.useState)(!1),[k,S]=(0,n.useState)(null),T=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=document.querySelector(".js-plotly-plot");if(t){let s=e?"grabbing":"grab";t.setAttribute("style","cursor: ".concat(s," !important"));let a=t.getElementsByTagName("*");for(let e=0;e<a.length;e++)a[e].style.cursor=s}};(0,n.useEffect)(()=>{if(!o)return;let e=(e=>{switch(e){case"15":case"60":case"240":default:return 500;case"1D":return 365}})(s);A(!1,e);let t=setInterval(()=>{A(!0,e)},1e4);return()=>clearInterval(t)},[t,s,o]),(0,n.useEffect)(()=>{let e=e=>{if("Space"===e.code&&!e.repeat&&!v){e.preventDefault(),w(!0),T(!1);let t=document.querySelector(".js-plotly-plot");t&&window.Plotly&&window.Plotly.relayout(t,{dragmode:!1,"xaxis.fixedrange":!0,"yaxis.fixedrange":!0,"yaxis2.fixedrange":!0})}},t=e=>{if("Space"===e.code){e.preventDefault(),w(!1),N(!1);let t=document.querySelector(".js-plotly-plot");if(t){t.setAttribute("style","cursor: default !important");let e=t.getElementsByTagName("*");for(let t=0;t<e.length;t++)e[t].style.cursor="default"}let s=document.querySelector(".js-plotly-plot");s&&window.Plotly&&window.Plotly.relayout(s,{dragmode:"zoom","xaxis.fixedrange":!1,"yaxis.fixedrange":!1,"yaxis2.fixedrange":!1})}};return window.addEventListener("keydown",e),window.addEventListener("keyup",t),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",t)}},[v]),(0,n.useEffect)(()=>{if(!b.current||!h.current)return;let e=e=>{v&&(e.preventDefault(),N(!0),S({x:e.clientX,y:e.clientY}),b.current&&(b.current.style.cursor="grabbing"))},t=e=>{if(!j||!k||!v)return;T(!0);let t=e.clientX-k.x,s=e.clientY-k.y,a=document.querySelector(".js-plotly-plot");if(a&&a._fullLayout){let e=a._fullLayout.xaxis.range,n=a._fullLayout.yaxis2.range,l=(new Date(e[1]).getTime()-new Date(e[0]).getTime())*(t/a.clientWidth),o=(n[1]-n[0])*(s/a.clientHeight);window.Plotly.relayout(a,{"xaxis.range[0]":new Date(new Date(e[0]).getTime()-l).toISOString(),"xaxis.range[1]":new Date(new Date(e[1]).getTime()-l).toISOString(),"yaxis2.range[0]":n[0]-o,"yaxis2.range[1]":n[1]-o})}S({x:e.clientX,y:e.clientY})},s=()=>{j&&(N(!1),b.current&&(b.current.style.cursor=v?"grab":"default"))},a=b.current;return a.addEventListener("mousedown",e),window.addEventListener("mousemove",t),window.addEventListener("mouseup",s),()=>{a.removeEventListener("mousedown",e),window.removeEventListener("mousemove",t),window.removeEventListener("mouseup",s)}},[v,j,k]);let A=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200;try{e||m(!0),x("");let n=t.replace(/USDT$/,""),l=await fetch("".concat("http://127.0.0.1:8000","/history?symbol=").concat(n,"&interval=").concat(s,"&limit=").concat(a));if(!l.ok)throw Error("數據獲取失敗: ".concat(l.statusText));let o=(await l.json()).candles||[];if(0===o.length)throw Error("無可用數據");let r={timestamps:o.map(e=>e.ts),open:o.map(e=>e.open),high:o.map(e=>e.high),low:o.map(e=>e.low),close:o.map(e=>e.close),volume:o.map(e=>e.volume)};p(r)}catch(e){x(e instanceof Error?e.message:"載入圖表失敗"),console.error("Chart loading error:",e)}finally{e||m(!1)}},C=(0,n.useMemo)(()=>"RSI"===c||"MACD"===c?{showlegend:!1,hovermode:"closest",hoverlabel:{bgcolor:"#ffffff",bordercolor:"#999999",font:{color:"#000000",family:"微軟正黑體",size:13},align:"left"},xaxis:{rangeslider:{visible:!1},type:"date",title:{text:"時間",font:{family:"微軟正黑體"}},tickformat:"%Y年%m月%d日 %H:%M",tickfont:{family:"微軟正黑體"},showgrid:!0,gridcolor:"rgba(128,128,128,0.2)"},yaxis:{domain:[0,.12],showgrid:!0,gridcolor:"rgba(128,128,128,0.2)",title:{text:"成交量 (USDT)",font:{family:"微軟正黑體"}},tickfont:{family:"微軟正黑體"}},yaxis3:{domain:[.12,.32],title:{text:"RSI"===c?"RSI":"MACD",font:{family:"微軟正黑體"}},tickfont:{family:"微軟正黑體"},showgrid:!0,gridcolor:"rgba(128,128,128,0.12)"},yaxis2:{domain:[.32,1],title:{text:"價格 (USDT)",font:{family:"微軟正黑體"}},tickfont:{family:"微軟正黑體"},showgrid:!0,gridcolor:"rgba(128,128,128,0.2)"},grid:{rows:3,columns:1,pattern:"independent"},height:680,margin:{t:0,b:40,r:40,l:40},paper_bgcolor:"transparent",plot_bgcolor:"transparent",font:{family:"微軟正黑體"}}:{showlegend:!1,hovermode:"closest",hoverlabel:{bgcolor:"#ffffff",bordercolor:"#999999",font:{color:"#000000",family:"微軟正黑體",size:13},align:"left"},xaxis:{rangeslider:{visible:!1},type:"date",title:{text:"時間",font:{family:"微軟正黑體"}},tickformat:"%Y年%m月%d日 %H:%M",tickfont:{family:"微軟正黑體"},showgrid:!0,gridcolor:"rgba(128,128,128,0.2)"},yaxis:{domain:[0,.2],showgrid:!0,gridcolor:"rgba(128,128,128,0.2)",title:{text:"成交量 (BTC)",font:{family:"微軟正黑體"}},tickfont:{family:"微軟正黑體"}},yaxis2:{domain:[.2,1],title:{text:"價格 (USDT)",font:{family:"微軟正黑體"}},tickfont:{family:"微軟正黑體"},showgrid:!0,gridcolor:"rgba(128,128,128,0.2)"},grid:{rows:2,columns:1,pattern:"independent"},height:600,margin:{t:0,b:40,r:40,l:40},paper_bgcolor:"transparent",plot_bgcolor:"transparent",font:{family:"微軟正黑體"}},[]),E=(0,n.useMemo)(()=>{if(!u)return null;let e=u.close;return"MA"===c?{ma:(t=>{let s=[];for(let a=0;a<e.length;a++){if(a<t-1){s.push(null);continue}let n=0;for(let s=a-t+1;s<=a;s++)n+=e[s];s.push(n/t)}return s})(20)}:"RSI"===c?{rsi:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:14,s=[],a=0,n=0;for(let l=0;l<e.length;l++){if(0===l){s.push(null);continue}let o=e[l]-e[l-1],r=Math.max(0,o),i=Math.max(0,-o);if(l<=t){if(a+=r,n+=i,s.push(null),l===t){let e=a/t,o=n/t,r=0===o?100:e/o;s[l]=100-100/(1+r)}}else{a=(a*(t-1)+r)/t;let e=0==(n=(n*(t-1)+i)/t)?100:a/n;s.push(100-100/(1+e))}}return s}(14)}:"MACD"===c?function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:26,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:9,n=(e,t)=>{let s=2/(t+1),a=[],n=null;for(let l=0;l<e.length;l++){if(l<t-1){a.push(null);continue}if(l===t-1){let s=0;for(let t=0;t<=l;t++)s+=e[t];n=s/t,a.push(n);continue}n=(e[l]-n)*s+n,a.push(n)}return a},l=n(e,t).map(e=>null===e?null:e),o=n(e,s).map(e=>null===e?null:e),r=[];for(let t=0;t<e.length;t++){let e=l[t],s=o[t];r.push(null===e||null===s?null:e-s)}let i=n(r.map(e=>null===e?0:e),a).map((e,t)=>null===r[t]?null:e);return{macdLine:r,signalLine:i}}(12,26,9):null},[u,c]);return(0,a.jsx)(r,{className:"w-full",children:(0,a.jsxs)("div",{className:"p-4",children:[d&&(0,a.jsxs)("div",{className:"flex justify-center items-center h-[400px]",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"}),(0,a.jsx)("span",{className:"ml-2",children:"載入中..."})]}),g&&(0,a.jsx)("div",{className:"text-red-500 text-center p-4",children:g}),u&&!d&&!g&&(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("div",{className:"mb-2 flex justify-end",children:(0,a.jsxs)("button",{onClick:()=>{var e;if(y(null),null==(e=h.current)?void 0:e.el){let e=h.current.el;window.Plotly.relayout(e,{"xaxis.autorange":!0,"yaxis.autorange":!0,"yaxis2.autorange":!0,"xaxis.rangeslider.visible":!1})}},className:"px-3 py-1 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded text-sm flex items-center",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"w-4 h-4 mr-1",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),"重設大小"]})}),(0,a.jsx)("div",{className:"relative w-full",ref:b,style:{cursor:v?j?"grabbing":"grab":"default"},children:(0,a.jsx)(i,{data:[{type:"candlestick",x:u.timestamps.map(e=>new Date(e).toISOString()),close:u.close,high:u.high,low:u.low,open:u.open,showlegend:!1,xaxis:"x",yaxis:"y2",hovertemplate:"<b>%{x}</b><br><br>開盤：%{open:.2f}<br>最高：%{high:.2f}<br>最低：%{low:.2f}<br>收盤：%{close:.2f}<extra></extra>",increasing:{line:{color:"#FF5000"}},decreasing:{line:{color:"#0ECB81"}}},{type:"bar",x:u.timestamps.map(e=>new Date(e).toISOString()),y:u.volume,showlegend:!1,xaxis:"x",yaxis:"y",hovertemplate:"%{x}<br>成交量: %{y:.2f}<extra></extra>",marker:{color:u.close.map((e,t)=>t>0&&e>u.close[t-1]?"rgba(255,0,0,0.5)":"rgba(0,255,0,0.5)")}},..."MA"===c&&E&&E.ma?[{type:"scatter",x:u.timestamps.map(e=>new Date(e).toISOString()),y:E.ma,mode:"lines",line:{color:"#0066ff",width:2},xaxis:"x",yaxis:"y2",name:"MA(20)",hovertemplate:"<b>%{x}</b><br><br>MA(20)：%{y:.4f}<extra></extra>"}]:[],..."RSI"===c&&E&&E.rsi?[{type:"scatter",x:u.timestamps.map(e=>new Date(e).toISOString()),y:E.rsi,mode:"lines",line:{color:"#ff9900",width:1.5},xaxis:"x",yaxis:"y3",name:"RSI(14)",hovertemplate:"<b>%{x}</b><br><br>RSI(14)：%{y:.2f}<extra></extra>"}]:[],..."MACD"===c&&E&&E.macdLine?[{type:"scatter",x:u.timestamps.map(e=>new Date(e).toISOString()),y:E.macdLine,mode:"lines",line:{color:"#22c55e",width:1.5},xaxis:"x",yaxis:"y3",name:"MACD",hovertemplate:"<b>%{x}</b><br><br>MACD：%{y:.4f}<extra></extra>"},{type:"scatter",x:u.timestamps.map(e=>new Date(e).toISOString()),y:E.signalLine,mode:"lines",line:{color:"#ef4444",width:1},xaxis:"x",yaxis:"y3",name:"Signal",hovertemplate:"Signal: %{y:.4f}<br>%{x}<extra></extra>"}]:[]],as:!0,any:!0,layout:{...C,paper_bgcolor:"transparent",plot_bgcolor:"transparent",font:{family:"微軟正黑體"},xaxis:{...C.xaxis,tickformat:"%Y年%m月%d日 %H:%M",title:{text:"時間",font:{family:"微軟正黑體"}},tickfont:{family:"微軟正黑體"},showgrid:!0,gridcolor:"rgba(128,128,128,0.2)",range:(null==f?void 0:f.xaxis)?[f.xaxis.start,f.xaxis.end]:void 0},yaxis:{...C.yaxis,title:{text:"成交量 (USDT)",font:{family:"微軟正黑體"}},tickfont:{family:"微軟正黑體"},showgrid:!0,gridcolor:"rgba(128,128,128,0.2)"},yaxis2:{...C.yaxis2,title:{text:"價格 (USDT)",font:{family:"微軟正黑體"}},tickfont:{family:"微軟正黑體"},showgrid:!0,gridcolor:"rgba(128,128,128,0.2)",range:(null==f?void 0:f.yaxis2)?[f.yaxis2.start,f.yaxis2.end]:void 0}},config:{responsive:!0,scrollZoom:!v,displayModeBar:!1,displaylogo:!1,staticPlot:!1,showSendToCloud:!1,locale:"zh-TW",doubleClick:!1,modeBarButtonsToRemove:["zoom2d","pan2d","select2d","lasso2d","zoomIn2d","zoomOut2d","autoScale2d","resetScale2d"]},className:"w-full",onRelayout:e=>{if(e["xaxis.autorange"]||e["yaxis2.autorange"])return void y(null);(e["xaxis.range[0]"]||e["yaxis2.range[0]"])&&y({xaxis:e["xaxis.range[0]"]?{start:e["xaxis.range[0]"],end:e["xaxis.range[1]"]}:void 0,yaxis2:e["yaxis2.range[0]"]?{start:e["yaxis2.range[0]"],end:e["yaxis2.range[1]"]}:void 0})}})})]})]})})}let d={BTC:"Bitcoin",ETH:"Ethereum",SOL:"Solana",ADA:"Cardano",XRP:"Ripple",DOGE:"Dogecoin",DOT:"Polkadot",MATIC:"Polygon",LINK:"Chainlink",UNI:"Uniswap",AVAX:"Avalanche",ATOM:"Cosmos",LTC:"Litecoin",ETC:"Ethereum Classic",FIL:"Filecoin",XLM:"Stellar",ALGO:"Algorand",NEAR:"NEAR Protocol",ICP:"Internet Computer",VET:"VeChain",AAVE:"Aave",AXS:"Axie Infinity",GRT:"The Graph",SAND:"The Sandbox",MANA:"Decentraland",THETA:"Theta Network",FTM:"Fantom",XTZ:"Tezos",EOS:"EOS",CAKE:"PancakeSwap",CHZ:"Chiliz",ZIL:"Zilliqa",BAT:"Basic Attention Token",ENJ:"Enjin Coin",COMP:"Compound",ONE:"Harmony",HOT:"Holo",BTT:"BitTorrent",IOTA:"IOTA",WAVES:"Waves",NEO:"NEO",DASH:"Dash",XEM:"NEM",ZEC:"Zcash",QTUM:"Qtum",ICX:"ICON",ONT:"Ontology",ZRX:"0x Protocol",KNC:"Kyber Network",OMG:"OMG Network",BNB:"Binance Coin",OKB:"OKB Token",CRO:"Crypto.com Chain",KCS:"KuCoin Token",HT:"Huobi Token"},m=e=>d[e]||e,g={BTC:"Layer 1",ETH:"Layer 1",SOL:"Layer 1",ADA:"Layer 1",DOT:"Layer 1",MATIC:"Layer 1",AVAX:"Layer 1",ATOM:"Layer 1",LTC:"Layer 1",ETC:"Layer 1",FIL:"Layer 1",XLM:"Layer 1",ALGO:"Layer 1",NEAR:"Layer 1",ICP:"Layer 1",VET:"Layer 1",FTM:"Layer 1",XTZ:"Layer 1",EOS:"Layer 1",WAVES:"Layer 1",NEO:"Layer 1",XEM:"Layer 1",QTUM:"Layer 1",ICX:"Layer 1",ONT:"Layer 1",ONE:"Layer 1",UNI:"DeFi",AAVE:"DeFi",COMP:"DeFi",CAKE:"DeFi",ZRX:"DeFi",KNC:"DeFi",LINK:"DeFi",GRT:"DeFi",AXS:"GameFi",SAND:"GameFi",MANA:"GameFi",ENJ:"GameFi",BNB:"交易所幣",OKB:"交易所幣",CRO:"交易所幣",KCS:"交易所幣",HT:"交易所幣",XRP:"其他",DOGE:"其他",THETA:"其他",CHZ:"其他",ZIL:"其他",BAT:"其他",HOT:"其他",BTT:"其他",IOTA:"其他",DASH:"其他",ZEC:"其他",OMG:"其他"},x={BTC:"/images/btc.png",ETH:"/images/eth.png",SOL:"/images/sol.png",ADA:"/images/ada.png",XRP:"/images/xrp.png",DOGE:"/images/doge.png",DOT:"/images/dot.png",MATIC:"/images/matic.png",LINK:"/images/link.png",UNI:"/images/uni.png",AVAX:"/images/avax.png",ATOM:"/images/atom.png",LTC:"/images/ltc.png",ETC:"/images/etc.png",FIL:"/images/fil.png",XLM:"/images/xlm.png",ALGO:"/images/algo.png",NEAR:"/images/near.png",ICP:"/images/icp.png",VET:"/images/vet.png",AAVE:"/images/aave.png",AXS:"/images/axs.png",GRT:"/images/grt.png",SAND:"/images/sand.png",MANA:"/images/mana.png",THETA:"/images/theta.png",FTM:"/images/ftm.png",XTZ:"/images/xtz.png",EOS:"/images/eos.png",CAKE:"/images/cake.png",CHZ:"/images/chz.png",ZIL:"/images/zil.png",BAT:"/images/bat.png",ENJ:"/images/enj.png",COMP:"/images/comp.png",ONE:"/images/one.png",HOT:"/images/hot.png",BTT:"/images/btt.png",IOTA:"/images/iota.png",WAVES:"/images/waves.png",NEO:"/images/neo.png",DASH:"/images/dash.png",XEM:"/images/xem.png",ZEC:"/images/zec.png",QTUM:"/images/qtum.png",ICX:"/images/icx.png",ONT:"/images/ont.png",ZRX:"/images/zrx.png",KNC:"/images/knc.png",OMG:"/images/omg.png",BNB:"/images/bnb.png",OKB:"/images/okb.png",CRO:"/images/cro.png",KCS:"/images/kcs.png",HT:"/images/ht.png"},u=[{value:"15m",label:"15 分鐘"},{value:"1h",label:"1 小時"},{value:"4h",label:"4 小時"},{value:"1d",label:"1 天"}],p=[{value:"RSI",label:"RSI"},{value:"MACD",label:"MACD"},{value:"MA",label:"均線"}],h=[{value:"low",label:"保守型"},{value:"medium",label:"中性"},{value:"high",label:"積極型"}];function b(e){return e>=1e3?new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:0,useGrouping:!0}).format(e):e.toFixed(2)}let f=e=>{let{timestamp:t}=e,[,s]=(0,n.useState)(0),l=(0,n.useRef)(null);if((0,n.useEffect)(()=>(l.current=setInterval(()=>{s(Date.now())},1e3),()=>{l.current&&clearInterval(l.current)}),[]),!t)return(0,a.jsx)("div",{className:"text-xs text-foreground/50 w-20 text-right",children:"-"});let o=Math.floor((Date.now()-t)/1e3),r="";return r=o<60?"".concat(o,"s ago"):o<3600?"".concat(Math.floor(o/60),"m ago"):"".concat(Math.floor(o/3600),"h ago"),(0,a.jsx)("div",{className:"text-xs text-foreground/50 w-20 text-right",children:r})},y=()=>{var e,t,s;let[l,o]=(0,n.useState)(""),[r,i]=(0,n.useState)(""),[d,y]=(0,n.useState)([]),[v,w]=(0,n.useState)(""),[j,N]=(0,n.useState)("全部"),[k,S]=(0,n.useState)(""),[T,A]=(0,n.useState)({}),[C,E]=(0,n.useState)({}),[L,O]=(0,n.useState)(!1),M=n.useRef(null),D=(0,n.useRef)(null),[I,_]=(0,n.useState)("disconnected"),[F,P]=(0,n.useState)(0),B=(0,n.useRef)(null),[R,H]=n.useState(0),[X,U]=n.useState(!1),[G,K]=(0,n.useState)([]),[z,Z]=(0,n.useState)({}),[V,W]=(0,n.useState)(!1),[$,q]=(0,n.useState)(""),[J,Y]=(0,n.useState)(!1),[Q,ee]=(0,n.useState)(!1),[et,es]=(0,n.useState)(!1),[ea,en]=(0,n.useState)(""),[el,eo]=(0,n.useState)(""),er={bg:J?"bg-neutral-900":"bg-white",main:J?"bg-neutral-800":"bg-white",btnSecondary:J?"bg-neutral-700 hover:bg-neutral-600 text-neutral-100":"bg-neutral-200 hover:bg-neutral-300 text-neutral-900",btn:J?"bg-blue-600 hover:bg-blue-500 text-white":"bg-blue-500 hover:bg-blue-600 text-white",btnDisabled:J?"bg-neutral-700 text-neutral-500 cursor-not-allowed":"bg-neutral-200 text-neutral-400 cursor-not-allowed",btnTag:J?"bg-neutral-700":"bg-neutral-200",label:J?"text-neutral-200":"text-neutral-700",input:J?"bg-neutral-800 border-neutral-700 text-neutral-100":"bg-white border-neutral-300 text-neutral-900",select:J?"bg-neutral-800 border-neutral-700 text-neutral-100":"bg-white border-neutral-300 text-neutral-900"},ei=Object.keys(x).filter(e=>{let t=e.toUpperCase(),s=v.trim().toUpperCase(),a=!s||t.includes(s)||m(e).toUpperCase().includes(s),n="全部"===j||g[e]===j;return a&&n});(0,n.useEffect)(()=>{{let e=localStorage.getItem("gemini_api_key");e&&(en(e),eo(e))}},[]),(0,n.useEffect)(()=>{let e=window.setInterval(()=>{P(Date.now())},1e3);return B.current=e,()=>{window.clearInterval(e)}},[]),(0,n.useEffect)(()=>{let e=()=>{var t;if((null==(t=M.current)?void 0:t.readyState)===WebSocket.OPEN)return;_("connecting");let s=new WebSocket("wss://stream.bybit.com/v5/public/spot");M.current=s,s.onopen=()=>{_("connected");let e=Object.keys(x).map(e=>"".concat(e,"USDT"));s.send(JSON.stringify({op:"subscribe",args:e.map(e=>"tickers.".concat(e))}))},s.onclose=()=>{_("disconnected"),D.current=window.setTimeout(e,5e3)},s.onmessage=e=>{try{var t;let s=JSON.parse(e.data);if((null==(t=s.topic)?void 0:t.startsWith("tickers."))&&s.data){let e=s.data.symbol.replace("USDT","");E(t=>({...t,[e]:{price:parseFloat(s.data.lastPrice)||0,change24h:100*parseFloat(s.data.price24hPcnt)||0,high24h:parseFloat(s.data.high24h)||0,low24h:parseFloat(s.data.low24h)||0,volume24h:parseFloat(s.data.volume24h)||0,lastUpdate:Date.now()}}))}}catch(e){console.error("WebSocket 數據處理錯誤:",e)}}};return e(),()=>{D.current&&clearTimeout(D.current),M.current&&M.current.close()}},[]),(0,n.useEffect)(()=>{(async()=>{try{let e=await fetch("https://api.bybit.com/v5/market/tickers?category=spot"),t=await e.json(),s={},a={};0===t.retCode&&t.result&&t.result.list&&t.result.list.forEach(e=>{if(e.symbol&&e.symbol.endsWith("USDT")){let t=e.symbol.replace("USDT","");a[t]={price:parseFloat(e.lastPrice)||0,change24h:100*parseFloat(e.price24hPcnt)||0,high24h:parseFloat(e.highPrice24h)||0,low24h:parseFloat(e.lowPrice24h)||0,volume24h:parseFloat(e.volume24h)||0,lastUpdate:Date.now()},s[t]="/images/".concat(t.toLowerCase(),".png")}});let n={BTC:"https://assets.coingecko.com/coins/images/1/small/bitcoin.png",ETH:"https://assets.coingecko.com/coins/images/279/small/ethereum.png",SOL:"https://assets.coingecko.com/coins/images/4128/small/solana.png",ADA:"https://assets.coingecko.com/coins/images/975/small/cardano.png",XRP:"https://assets.coingecko.com/coins/images/44/small/xrp-symbol-white-128.png",DOGE:"https://assets.coingecko.com/coins/images/5/small/dogecoin.png",DOT:"https://assets.coingecko.com/coins/images/12171/small/polkadot.png",MATIC:"https://assets.coingecko.com/coins/images/4713/small/matic-token-icon.png",LINK:"https://assets.coingecko.com/coins/images/877/small/chainlink-new-logo.png",UNI:"https://assets.coingecko.com/coins/images/12504/small/uniswap-uni.png",AVAX:"https://assets.coingecko.com/coins/images/12559/small/coin-round-red.png",ATOM:"https://assets.coingecko.com/coins/images/1481/small/cosmos_hub.png",LTC:"https://assets.coingecko.com/coins/images/2/small/litecoin.png",ETC:"https://assets.coingecko.com/coins/images/453/small/ethereum-classic-logo.png",FIL:"https://assets.coingecko.com/coins/images/12817/small/filecoin.png",XLM:"https://assets.coingecko.com/coins/images/100/small/Stellar_symbol_black_RGB.png",ALGO:"https://assets.coingecko.com/coins/images/4380/small/download.png",NEAR:"https://assets.coingecko.com/coins/images/10365/small/near_icon.png",ICP:"https://assets.coingecko.com/coins/images/14495/small/Internet_Computer_logo.png",VET:"https://assets.coingecko.com/coins/images/1167/small/VeChain-Logo-768x725.png",AAVE:"https://assets.coingecko.com/coins/images/12645/small/AAVE.png",AXS:"https://assets.coingecko.com/coins/images/13029/small/axie_infinity_logo.png",GRT:"https://assets.coingecko.com/coins/images/13397/small/Graph_Token.png",SAND:"https://assets.coingecko.com/coins/images/12129/small/sandbox_logo.jpg",MANA:"https://assets.coingecko.com/coins/images/878/small/decentraland-mana.png",THETA:"https://assets.coingecko.com/coins/images/2538/small/theta-token-logo.png",FTM:"https://assets.coingecko.com/coins/images/4001/small/Fantom.png",XTZ:"https://assets.coingecko.com/coins/images/976/small/Tezos-logo.png",EOS:"https://assets.coingecko.com/coins/images/738/small/eos-eos-logo.png",CAKE:"https://assets.coingecko.com/coins/images/12632/small/pancakeswap-cake-logo_%281%29.png",CHZ:"https://assets.coingecko.com/coins/images/8834/small/Chiliz.png",ZIL:"https://assets.coingecko.com/coins/images/2687/small/Zilliqa-logo.png",BAT:"https://assets.coingecko.com/coins/images/677/small/basic-attention-token.png",ENJ:"https://assets.coingecko.com/coins/images/1102/small/enjin-coin-logo.png",COMP:"https://assets.coingecko.com/coins/images/10775/small/COMP.png",ONE:"https://assets.coingecko.com/coins/images/4344/small/Y88JAze.png",HOT:"https://assets.coingecko.com/coins/images/3348/small/Holo.png",BTT:"https://assets.coingecko.com/coins/images/7595/small/BTT_Token_Graphic.png",IOTA:"https://assets.coingecko.com/coins/images/692/small/IOTA_Swirl.png",WAVES:"https://assets.coingecko.com/coins/images/425/small/waves.png",NEO:"https://assets.coingecko.com/coins/images/480/small/NEO_512_512.png",DASH:"https://assets.coingecko.com/coins/images/19/small/dash-logo.png",XEM:"https://assets.coingecko.com/coins/images/242/small/NEM_Logo_256x256.png",ZEC:"https://assets.coingecko.com/coins/images/486/small/circle-zcash-color.png",QTUM:"https://assets.coingecko.com/coins/images/684/small/qtum.png",ICX:"https://assets.coingecko.com/coins/images/1060/small/icon-icx-logo.png",ONT:"https://assets.coingecko.com/coins/images/3447/small/ONT.png",ZRX:"https://assets.coingecko.com/coins/images/863/small/0x.png",KNC:"https://assets.coingecko.com/coins/images/14899/small/RwdVsGcw_400x400.jpg",OMG:"https://assets.coingecko.com/coins/images/776/small/OMG_Network.jpg"};Object.keys(n).forEach(e=>{s[e]||(s[e]=n[e])}),A(s),E(a)}catch(e){console.error("Error fetching coin images:",e),A({BTC:"https://assets.coingecko.com/coins/images/1/small/bitcoin.png",ETH:"https://assets.coingecko.com/coins/images/279/small/ethereum.png"})}})()},[]),(0,n.useEffect)(()=>{Q&&(ee(!1),Z({}))},[l,r,d,k]),(0,n.useEffect)(()=>{L&&ec()},[L]),(0,n.useEffect)(()=>{L&&K(d)},[L]),(0,n.useEffect)(()=>{try{let e=localStorage.getItem("darkMode");if("0"===e||"1"===e){let t="1"===e;Y(t);let s=document.documentElement;t?s.classList.add("dark"):s.classList.remove("dark")}}catch(e){}},[]),(0,n.useEffect)(()=>{try{localStorage.setItem("darkMode",J?"1":"0")}catch(e){}},[J]);let ec=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{let t=Date.now();if(!e&&t-R<5e3)return;H(t),U(!0);let s=await fetch("https://api.bybit.com/v5/market/tickers?category=spot");if(!s.ok)return void U(!1);let a=await s.json(),n={},l={};0===a.retCode&&a.result&&a.result.list&&a.result.list.forEach(e=>{if(e.symbol&&e.symbol.endsWith("USDT")){let s=e.symbol.replace("USDT","");n[s]={price:parseFloat(e.lastPrice)||0,change24h:100*parseFloat(e.price24hPcnt)||0,high24h:parseFloat(e.highPrice24h)||0,low24h:parseFloat(e.lowPrice24h)||0,volume24h:parseFloat(e.volume24h)||0,lastUpdate:t},l[s]="/images/".concat(s.toLowerCase(),".png")}}),E(e=>({...e,...n})),A(e=>({...e,...l}))}catch(e){}finally{U(!1)}},ed=async()=>{if(q(""),ee(!1),!l||!r||0===d.length)return void q("⚠️ 請先選擇風險偏好、技術指標與幣種！");W(!0);try{let e={risk:l,indicator:r,coins:d,interval:k};ea&&(e.gemini_api_key=ea);let t=await fetch("http://127.0.0.1:8000/analyze",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error(await t.text()||"後端返回錯誤");let s=await t.json(),a={};s.recommendations.forEach(e=>{var t,s,n,l,o,r,i,c,d;a[e.coin]={suggestion:e.action||e.suggestion||"等待分析",reason:e.rationale&&e.rationale.length?e.rationale.join("； "):e.reason||"等待技術分析結果",trend:e.trend||e.trend||"",confidence:null!=(t=e.confidence)?t:null,position_pct:null!=(s=e.position_pct)?s:null,entry_plan:null!=(n=e.entry_plan)?n:null,stop_loss:null!=(l=e.stop_loss)?l:null,take_profit:null!=(o=e.take_profit)?o:null,indicators:null!=(r=e.indicators)?r:null,risk:null!=(i=e.risk)?i:null,risk_raw:null!=(c=e.risk_raw)?c:null,ai_analysis:null!=(d=e.ai_analysis)?d:null}}),Z(a),ee(!0)}catch(e){q("❌ 後端連線失敗，請確認 FastAPI 是否啟動中。")}finally{W(!1)}};return(0,a.jsxs)("div",{className:"".concat(er.bg," min-h-screen w-full p-0 m-0 font-sans"),children:[(0,a.jsxs)("div",{className:"w-full h-14 flex items-center px-8 bg-card border-b border-border shadow-sm select-none",children:[(0,a.jsx)("span",{className:"text-xl font-bold tracking-wide mr-8 text-foreground",children:"智慧加密貨幣投資建議系統"}),(0,a.jsx)("span",{className:"text-foreground/60 mr-2",children:"風險偏好："}),(0,a.jsx)("span",{className:"text-foreground font-semibold mr-4",children:(null==(e=h.find(e=>e.value===l))?void 0:e.label)||"未選擇"}),(0,a.jsx)("span",{className:"text-foreground/60 mr-2",children:"指標："}),(0,a.jsx)("span",{className:"text-foreground font-semibold mr-4",children:(null==(t=p.find(e=>e.value===r))?void 0:t.label)||"未選擇"}),(0,a.jsx)("span",{className:"text-foreground/60 mr-2",children:"幣種："}),(0,a.jsx)("span",{className:"text-foreground font-semibold mr-4",children:d.length?d.join(", "):"未選擇"}),(0,a.jsx)("span",{className:"text-foreground/60 mr-2",children:"區間："}),(0,a.jsx)("span",{className:"text-foreground font-semibold",children:(null==(s=u.find(e=>e.value===k))?void 0:s.label)||"未選擇"}),(0,a.jsx)("button",{className:"".concat(er.btnSecondary," ml-auto px-4 py-1 rounded text-sm font-semibold"),onClick:()=>{let e=document.documentElement,t=!e.classList.contains("dark");t?e.classList.add("dark"):e.classList.remove("dark"),Y(t);try{localStorage.setItem("darkMode",t?"1":"0")}catch(e){}},children:J?"☀️ 淺色模式":"\uD83C\uDF19 深色模式"}),(0,a.jsx)("button",{className:"".concat(er.btnSecondary," ml-2 px-4 py-1 rounded text-sm font-semibold"),onClick:()=>{eo(ea),es(!0)},children:"⚙️ AI 設置"})]}),(0,a.jsxs)("main",{className:"w-full min-h-screen ".concat(er.main," p-8 rounded-none shadow-none border-0"),children:[$&&(0,a.jsx)("div",{className:"mb-4 text-center text-red-500 font-medium",children:$}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-base font-semibold ".concat(er.label," mb-2"),children:"風險偏好"}),(0,a.jsx)("div",{className:"flex flex-col gap-2",children:h.map(e=>(0,a.jsxs)("label",{className:"inline-flex items-center cursor-pointer",children:[(0,a.jsx)("input",{type:"radio",className:"form-radio accent-[#1e88e5] h-4 w-4 mr-2",value:e.value,checked:l===e.value,onChange:()=>o(e.value)}),(0,a.jsx)("span",{className:l===e.value?"text-primary font-bold":"text-foreground/80",children:e.label})]},e.value))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-base font-semibold ".concat(er.label," mb-2"),children:"技術指標"}),(0,a.jsxs)("select",{className:"w-full border rounded p-2 focus:outline-none ".concat(er.select),value:r,onChange:e=>i(e.target.value),children:[(0,a.jsx)("option",{value:"",children:"請選擇技術指標"}),p.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-base font-semibold ".concat(er.label," mb-2"),children:"選擇幣種"}),(0,a.jsx)("button",{type:"button",onClick:()=>O(!0),className:"w-full text-left px-3 py-2 rounded border ".concat(er.input," hover:opacity-95"),children:d.length?d.join(", "):"請點選以選擇幣種"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-base font-semibold ".concat(er.label," mb-2"),children:"時間區間"}),(0,a.jsxs)("select",{className:"w-full border rounded p-2 focus:outline-none ".concat(er.select),value:k,onChange:e=>S(e.target.value),children:[(0,a.jsx)("option",{value:"",children:"請選擇時間區間"}),u.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))]})]})]}),(0,a.jsx)("div",{className:"text-center mb-8",children:(0,a.jsx)("button",{onClick:ed,disabled:V||!l||!r||0===d.length,className:"w-48 text-base py-2 rounded font-semibold transition-colors border ".concat(!V&&l&&r&&0!==d.length?er.btn:er.btnDisabled),children:V?"分析中...":"開始分析"})}),Q&&z&&Object.keys(z).length>0&&(0,a.jsx)("div",{className:"grid grid-cols-1 gap-6",children:Object.keys(z).map(e=>{var t,s,n,l,o,i,d,g,x,u,p,h,f,y,v,w,j,N,S,T,A,E,L,O;return(0,a.jsxs)("div",{className:"bg-card rounded-lg border border-border p-4",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-4 mb-6 p-6 bg-gradient-to-br from-card to-card/90 rounded-xl border border-border/50 shadow-lg backdrop-blur-sm",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"w-16 h-16 relative p-1 bg-gradient-to-tr from-primary/30 to-primary/20 rounded-2xl shadow-xl",children:(0,a.jsx)("div",{className:"w-full h-full rounded-xl bg-card flex items-center justify-center overflow-hidden",children:(0,a.jsx)("img",{src:"/images/".concat(e.toLowerCase(),".png"),alt:e,className:"w-12 h-12 object-contain hover:scale-110 transition-transform",onError:t=>{var s,a;let n=t.target;n.style.display="none",null==(s=n.parentElement)||s.classList.add("bg-neutral-100","dark:bg-neutral-800"),null==(a=n.parentElement)||a.insertAdjacentHTML("beforeend",'<span class="text-2xl font-bold">'.concat(e,"</span>"))}})})}),(0,a.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("span",{className:"text-3xl font-bold tracking-tight bg-gradient-to-r from-primary to-primary/70 bg-clip-text text-transparent",children:e}),(0,a.jsx)("span",{className:"text-sm px-3 py-1 rounded-full bg-primary/20 text-primary font-semibold border border-primary/30 shadow-sm",children:"USDT"})]}),(0,a.jsx)("span",{className:"text-base text-foreground/70 font-medium",children:m(e)})]})]}),(0,a.jsxs)("div",{className:"flex flex-col items-end",children:[(0,a.jsxs)("div",{className:"flex items-baseline gap-3",children:[(0,a.jsxs)("div",{className:"text-4xl font-bold tracking-tighter tabular-nums",children:[(0,a.jsx)("span",{className:"text-2xl",children:"$"}),b((null==(t=C[e])?void 0:t.price)||0)]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-lg ".concat(((null==(s=C[e])?void 0:s.change24h)||0)>=0?"bg-green-500/20 text-green-500 border border-green-500/30":"bg-red-500/20 text-red-500 border border-red-500/30"," shadow-sm"),children:[(0,a.jsx)("span",{className:"text-xl font-bold",children:((null==(n=C[e])?void 0:n.change24h)||0)>=0?"↑":"↓"}),(0,a.jsxs)("span",{className:"text-base font-bold tabular-nums",children:[Math.abs((null==(l=C[e])?void 0:l.change24h)||0).toFixed(2),"%"]})]})]}),(0,a.jsxs)("div",{className:"text-base text-foreground/70 font-semibold mt-2 tabular-nums",children:["24h 變化：",(0,a.jsxs)("span",{className:((null==(o=C[e])?void 0:o.change24h)||0)>=0?"text-green-500 ml-1":"text-red-500 ml-1",children:[((null==(i=C[e])?void 0:i.change24h)||0)>=0?"+":"-","$",b(Math.abs(((null==(d=C[e])?void 0:d.price)||0)*(((null==(g=C[e])?void 0:g.change24h)||0)/100)))]})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-6 mt-2 p-4 bg-card/80 rounded-lg border border-border/50 shadow-inner",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-2 items-center justify-center p-3 bg-gradient-to-br from-card to-card/50 rounded-lg border border-border/30 shadow-sm",children:[(0,a.jsx)("span",{className:"text-sm text-foreground/70 font-medium",children:"24h 最高"}),(0,a.jsxs)("span",{className:"text-xl font-bold text-green-500 tabular-nums",children:["$",b((null==(x=C[e])?void 0:x.high24h)||0)]})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2 items-center justify-center p-3 bg-gradient-to-br from-card to-card/50 rounded-lg border border-border/30 shadow-sm",children:[(0,a.jsx)("span",{className:"text-sm text-foreground/70 font-medium",children:"24h 最低"}),(0,a.jsxs)("span",{className:"text-xl font-bold text-red-500 tabular-nums",children:["$",b((null==(u=C[e])?void 0:u.low24h)||0)]})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2 items-center justify-center p-3 bg-gradient-to-br from-card to-card/50 rounded-lg border border-border/30 shadow-sm",children:[(0,a.jsx)("span",{className:"text-sm text-foreground/70 font-medium",children:"24h 成交額"}),(0,a.jsxs)("span",{className:"text-xl font-bold text-primary tabular-nums",children:["$",(((null==(p=C[e])?void 0:p.volume24h)||0)*((null==(h=C[e])?void 0:h.price)||0)/1e6).toFixed(2),"M"]})]})]}),(0,a.jsxs)("div",{className:"mt-4 p-4 bg-gradient-to-br from-primary/5 to-transparent rounded-xl border border-primary/10 shadow-lg",children:[(0,a.jsxs)("div",{className:"text-lg font-bold mb-3 text-foreground/90 flex items-center gap-2",children:[(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-primary",children:[(0,a.jsx)("path",{d:"M2 3h20"}),(0,a.jsx)("path",{d:"M16 3v17H8V3"}),(0,a.jsx)("path",{d:"M12 12h.01"}),(0,a.jsx)("path",{d:"M12 8h.01"}),(0,a.jsx)("path",{d:"M12 16h.01"})]}),"投資建議"]}),(0,a.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"px-4 py-2 rounded-lg text-base font-bold ".concat(V?"bg-neutral-100 dark:bg-neutral-800 text-neutral-500":$?"bg-red-500/20 text-red-500 border border-red-500/30":(null==(f=z[e])?void 0:f.suggestion)==="建議買入"?"bg-green-500/20 text-green-500 border border-green-500/30 animate-pulse":(null==(y=z[e])?void 0:y.suggestion)==="建議賣出"?"bg-red-500/20 text-red-500 border border-red-500/30 animate-pulse":"bg-primary/20 text-primary border border-primary/30"," shadow-sm min-w-[120px] text-center"),children:V?"分析中...":$?"無法取得建議":(null==(v=z[e])?void 0:v.suggestion)||"等待分析"}),(0,a.jsx)("div",{className:"flex items-center gap-2 ".concat(V?"text-neutral-500":$?"text-red-500":(null==(w=z[e])?void 0:w.trend)==="上漲"?"text-green-500":(null==(j=z[e])?void 0:j.trend)==="下跌"?"text-red-500":"text-primary"),children:!V&&!$&&(null==(N=z[e])?void 0:N.trend)&&(0,a.jsxs)(a.Fragment,{children:[(null==(S=z[e])?void 0:S.trend)==="上漲"?(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("path",{d:"M7 17l9-9"}),(0,a.jsx)("path",{d:"M17 17V8"}),(0,a.jsx)("path",{d:"M7 8h10"})]}):(null==(T=z[e])?void 0:T.trend)==="下跌"?(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("path",{d:"M7 7l9 9"}),(0,a.jsx)("path",{d:"M17 7H8"}),(0,a.jsx)("path",{d:"M7 7v9"})]}):null,(0,a.jsx)("span",{className:"font-semibold",children:null==(A=z[e])?void 0:A.trend})]})})]}),(0,a.jsx)("div",{className:"text-base text-foreground/80 bg-card/50 p-3 rounded-lg border border-border/50",children:V?"正在進行技術分析...":$||(null==(E=z[e])?void 0:E.reason)||"等待技術分析結果"})]}),(null==(L=z[e])?void 0:L.ai_analysis)&&(0,a.jsxs)("div",{className:"mt-4 p-4 bg-gradient-to-br from-purple-500/5 to-transparent rounded-xl border border-purple-500/10 shadow-lg",children:[(0,a.jsxs)("div",{className:"text-lg font-bold mb-3 text-foreground/90 flex items-center gap-2",children:[(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-purple-500",children:[(0,a.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2z"}),(0,a.jsx)("path",{d:"M12 6v6l4 2"})]}),"AI 深度分析"]}),(0,a.jsx)("div",{className:"text-sm text-foreground/80 whitespace-pre-wrap bg-card/50 p-3 rounded-lg border border-border/50 max-h-96 overflow-y-auto",children:null==(O=z[e])?void 0:O.ai_analysis})]})]})]}),(0,a.jsx)(c,{symbol:"".concat(e,"USDT"),interval:"15m"===k?"15":"1h"===k?"60":"4h"===k?"240":"D",limit:200,shouldLoad:Q,indicator:r})]},e)})}),L&&(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black/50",onClick:()=>O(!1)}),(0,a.jsxs)("div",{className:"relative bg-card border-border rounded shadow-lg w-11/12 max-w-5xl h-4/5 overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b border-border",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"選擇幣種"}),(0,a.jsx)("input",{type:"text",placeholder:"搜尋代號或名稱",value:v,onChange:e=>w(e.target.value),className:"px-3 py-1 rounded bg-background border border-border text-sm"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{className:"".concat(er.btnSecondary," px-3 py-1 text-sm rounded"),onClick:()=>{w(""),N("全部"),K([]),y([])},children:"重置"}),(0,a.jsx)("button",{className:"".concat(er.btnSecondary," px-3 py-1 text-sm rounded"),onClick:()=>{ec(!0)},children:X?"刷新中...":"刷新行情"}),(0,a.jsx)("button",{className:"".concat(er.btn," px-3 py-1 rounded"),onClick:()=>{y(G),O(!1)},children:"套用"}),(0,a.jsx)("button",{className:"".concat(er.btnSecondary," px-3 py-1 rounded"),onClick:()=>O(!1),children:"取消"})]})]}),(0,a.jsxs)("div",{className:"flex h-full",children:[(0,a.jsxs)("div",{className:"w-3/4 border-r border-border p-3 overflow-y-auto",children:[(0,a.jsx)("div",{className:"mb-3 flex gap-2 overflow-x-auto",children:["全部","Layer 1","DeFi","GameFi","交易所幣","其他"].map(e=>(0,a.jsx)("button",{onClick:()=>N(e),className:"".concat(er.btnTag," px-3 py-1 rounded-full text-sm ").concat(j===e?"bg-primary text-white hover:bg-primary/90":""),children:e},e))}),(0,a.jsxs)("div",{className:"flex justify-between items-center px-2 py-2 border-b border-border mb-2",children:[(0,a.jsx)("div",{className:"flex-1",children:"幣種資訊"}),(0,a.jsxs)("div",{className:"flex min-w-[400px] justify-end items-center gap-4",children:[(0,a.jsxs)("div",{className:"text-sm text-foreground/70 min-w-[120px] text-right",children:[(0,a.jsx)("div",{children:"價格 (USD)"}),(0,a.jsx)("div",{className:"text-xs",children:"24h 高/低"})]}),(0,a.jsxs)("div",{className:"text-sm text-foreground/70 min-w-[100px] text-right",children:[(0,a.jsx)("div",{children:"24h 漲跌"}),(0,a.jsx)("div",{className:"text-xs",children:"24h 成交量"})]}),(0,a.jsx)("div",{className:"text-sm text-foreground/70 w-20 text-right",children:"更新時間"})]})]}),(0,a.jsxs)("div",{className:"text-xs mb-2 flex items-center gap-2 px-2 ".concat("connected"===I?"text-green-500":"connecting"===I?"text-yellow-500":"text-red-500"),children:[(0,a.jsx)("span",{className:"inline-block w-2 h-2 rounded-full bg-current"}),"connected"===I?"即時數據已連接":"connecting"===I?"正在連接...":"連接中斷"]}),(0,a.jsx)("div",{className:"grid grid-cols-1 gap-2",children:ei.map(e=>{var t,s;let n=C[e]||{price:0,change24h:0},l=G.includes(e);return(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 rounded ".concat(l?"bg-primary/10":"bg-card"," cursor-pointer"),onClick:()=>{K(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-7 h-7 flex-shrink-0 relative",children:(0,a.jsx)("img",{src:"/images/".concat(e.toLowerCase(),".png"),alt:e,className:"w-full h-full object-contain rounded-full",onError:t=>{var s,a;let n=t.target;n.style.display="none",null==(s=n.parentElement)||s.classList.add("bg-gray-100","dark:bg-gray-800"),null==(a=n.parentElement)||a.insertAdjacentHTML("beforeend",'<span class="absolute inset-0 flex items-center justify-center text-xs font-bold">'.concat(e,"</span>"))}})}),(0,a.jsx)("div",{className:"min-w-0",children:(0,a.jsxs)("div",{className:"text-sm font-medium truncate",children:[e," ",(0,a.jsx)("span",{className:"text-xs text-foreground/60",children:m(e)})]})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4 min-w-[400px] justify-end",children:[(0,a.jsxs)("div",{className:"flex flex-col items-end",children:[(0,a.jsxs)("div",{className:"text-sm font-medium relative group",children:[(0,a.jsx)("div",{className:"animate-fade-in bg-green-500/10 absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity rounded"}),"$",n.price.toLocaleString(),(0,a.jsx)("span",{className:"text-xs text-foreground/50 ml-1",children:"USD"})]},"".concat(e,"-").concat(n.price)),(0,a.jsxs)("div",{className:"text-xs text-foreground/60",children:["H: $",null==(t=n.high24h)?void 0:t.toLocaleString()," L: $",null==(s=n.low24h)?void 0:s.toLocaleString()]})]}),(0,a.jsxs)("div",{className:"flex flex-col items-end min-w-[100px]",children:[(0,a.jsx)("div",{className:"text-sm font-medium ".concat(n.change24h>=0?"text-green-500":"text-red-400"),children:n.change24h?(n.change24h>=0?"+":"")+n.change24h.toFixed(2)+"%":"-"}),(0,a.jsxs)("div",{className:"text-xs text-foreground/60",children:["Vol: $",(n.volume24h/1e6).toFixed(2),"M"]})]}),(0,a.jsx)(f,{timestamp:n.lastUpdate})]})]},e)})})]}),(0,a.jsxs)("div",{className:"w-1/4 p-3",children:[(0,a.jsx)("h4",{className:"text-sm font-semibold mb-2",children:"已選擇幣種"}),(0,a.jsxs)("div",{className:"flex flex-col gap-2 overflow-y-auto h-[70%]",children:[0===G.length&&(0,a.jsx)("div",{className:"text-foreground/60",children:"尚未選擇"}),G.map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-2 p-2 rounded border",children:[(0,a.jsx)("div",{className:"w-6 h-6 relative",children:(0,a.jsx)("img",{src:"/images/".concat(e.toLowerCase(),".png"),alt:e,className:"w-full h-full object-contain rounded-full",onError:t=>{var s,a;let n=t.target;n.style.display="none",null==(s=n.parentElement)||s.classList.add("bg-gray-100","dark:bg-gray-800"),null==(a=n.parentElement)||a.insertAdjacentHTML("beforeend",'<span class="absolute inset-0 flex items-center justify-center text-xs font-bold">'.concat(e,"</span>"))}})}),(0,a.jsx)("div",{className:"text-sm",children:e})]},e))]})]})]})]})]}),et&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"".concat(er.main," rounded-lg shadow-2xl p-6 w-96 border border-border"),children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4 text-foreground",children:"AI 深度分析設置"}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-sm font-semibold ".concat(er.label," mb-2"),children:"Google Gemini API Key"}),(0,a.jsxs)("p",{className:"text-xs text-foreground/60 mb-2",children:["取得免費金鑰：",(0,a.jsx)("a",{href:"https://ai.google.dev/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline",children:"https://ai.google.dev/"})]}),(0,a.jsx)("input",{type:"password",placeholder:"AIza_xxxxxxxxxxxxxxxxxxxxxxxx",value:el,onChange:e=>eo(e.target.value),className:"w-full border rounded p-3 focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(er.input)})]}),(0,a.jsxs)("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded p-3 mb-4 text-sm text-foreground/80",children:[(0,a.jsx)("strong",{children:"\uD83D\uDCA1 提示："}),(0,a.jsxs)("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[(0,a.jsx)("li",{children:"API Key 將保存在本機 (localStorage)"}),(0,a.jsx)("li",{children:"未設置 Key 時仍可使用技術分析"}),(0,a.jsx)("li",{children:"免費版每日限制約 1500 請求"})]})]}),(0,a.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,a.jsx)("button",{onClick:()=>{eo(ea),es(!1)},className:"".concat(er.btnSecondary," px-4 py-2 rounded text-sm font-semibold"),children:"取消"}),ea&&(0,a.jsx)("button",{onClick:()=>{window.confirm("確定要刪除保存的 API Key 嗎？")&&(localStorage.removeItem("gemini_api_key"),en(""),eo(""),alert("✓ API Key 已刪除"))},className:"bg-red-500/80 hover:bg-red-500 text-white px-4 py-2 rounded text-sm font-semibold",children:"刪除"}),(0,a.jsx)("button",{onClick:()=>el.trim()?el.startsWith("AIza")?void(localStorage.setItem("gemini_api_key",el),en(el),es(!1),alert("✓ API Key 已保存")):void alert("API Key 格式不正確，應以 'AIza' 開頭"):void alert("API Key 不能為空！"),className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded text-sm font-semibold",children:"保存"})]}),ea&&(0,a.jsx)("div",{className:"mt-3 text-xs text-green-600 dark:text-green-400 font-semibold",children:"✓ 已配置 API Key"})]})})]})]})}},8394:(e,t,s)=>{Promise.resolve().then(s.bind(s,743))}},e=>{e.O(0,[161,441,255,358],()=>e(e.s=8394)),_N_E=e.O()}]);